# ============================================================================
# Log4j2 Configuration for ECCS Logstash
# ============================================================================
# This file configures logging for Logstash itself (not for the log data 
# being processed).
#
# LOG LEVELS:
#   - fatal: System is unusable
#   - error: Error conditions
#   - warn:  Warning conditions
#   - info:  Informational messages
#   - debug: Debug-level messages
#   - trace: Most fine-grained information
#
# OUTPUT:
#   Logs are written to both console and file. In container deployments,
#   console output is typically preferred for log aggregation.
# ============================================================================

status = error
name = LogstashPropertiesConfig

# Console Appender
appender.console.type = Console
appender.console.name = console
appender.console.layout.type = PatternLayout
appender.console.layout.pattern = [%d{ISO8601}][%-5p][%-25c]%notEmpty{[%X{pipeline.id}]}%notEmpty{[%X{plugin.id}]} %m%n

# File Appender (optional - for persistent logging)
appender.rolling.type = RollingFile
appender.rolling.name = rolling
appender.rolling.fileName = ${sys:ls.logs}/logstash-plain.log
appender.rolling.filePattern = ${sys:ls.logs}/logstash-plain-%d{yyyy-MM-dd}-%i.log.gz
appender.rolling.policies.type = Policies
appender.rolling.policies.time.type = TimeBasedTriggeringPolicy
appender.rolling.policies.time.interval = 1
appender.rolling.policies.time.modulate = true
appender.rolling.policies.size.type = SizeBasedTriggeringPolicy
appender.rolling.policies.size.size = 100MB
appender.rolling.strategy.type = DefaultRolloverStrategy
appender.rolling.strategy.max = 30
appender.rolling.layout.type = PatternLayout
appender.rolling.layout.pattern = [%d{ISO8601}][%-5p][%-25c]%notEmpty{[%X{pipeline.id}]}%notEmpty{[%X{plugin.id}]} %m%n

# JSON File Appender (for structured logging)
appender.json_rolling.type = RollingFile
appender.json_rolling.name = json_rolling
appender.json_rolling.fileName = ${sys:ls.logs}/logstash-json.log
appender.json_rolling.filePattern = ${sys:ls.logs}/logstash-json-%d{yyyy-MM-dd}-%i.log.gz
appender.json_rolling.policies.type = Policies
appender.json_rolling.policies.time.type = TimeBasedTriggeringPolicy
appender.json_rolling.policies.time.interval = 1
appender.json_rolling.policies.time.modulate = true
appender.json_rolling.policies.size.type = SizeBasedTriggeringPolicy
appender.json_rolling.policies.size.size = 100MB
appender.json_rolling.strategy.type = DefaultRolloverStrategy
appender.json_rolling.strategy.max = 30
appender.json_rolling.layout.type = JSONLayout
appender.json_rolling.layout.compact = true
appender.json_rolling.layout.eventEol = true

# Root Logger
rootLogger.level = info
rootLogger.appenderRef.console.ref = console
# Uncomment to enable file logging:
# rootLogger.appenderRef.rolling.ref = rolling
# rootLogger.appenderRef.json_rolling.ref = json_rolling

# Slowlog Configuration
# Log slow events (events taking longer than 10 seconds to process)
logger.slowlog.name = slowlog
logger.slowlog.level = trace
logger.slowlog.appenderRef.console.ref = console
logger.slowlog.additivity = false

# Deprecation Logger
logger.deprecation.name = org.logstash.deprecation
logger.deprecation.level = warn
logger.deprecation.appenderRef.console.ref = console
logger.deprecation.additivity = false

# Reduce noise from verbose libraries
logger.netty.name = io.netty
logger.netty.level = warn

logger.http.name = org.apache.http
logger.http.level = warn

logger.reflections.name = org.reflections
logger.reflections.level = error

# License reader logs (reduce noise)
logger.licensereader.name = org.logstash.licensechecker
logger.licensereader.level = warn
