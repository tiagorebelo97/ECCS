# ============================================================================
# Logstash Configuration for ECCS Platform
# ============================================================================
# Main Logstash configuration file controlling global settings.
# Pipeline-specific settings are in pipeline/*.conf files.
#
# PIPELINES OVERVIEW:
#   1. eccs-main: Real-time log ingestion (TCP:5000, Beats:5044)
#   2. eccs-mongodb: MongoDB email logs to Elasticsearch
#
# ENVIRONMENT VARIABLES:
#   ELASTICSEARCH_HOSTS: Elasticsearch cluster URL (default: http://elasticsearch:9200)
#   MONGODB_URI: MongoDB connection string (default: mongodb://mongodb:27017/eccs_logs)
# ============================================================================

# -----------------------------------------------------------------------------
# Node Settings
# -----------------------------------------------------------------------------
# Name for this Logstash instance
node.name: eccs-logstash

# -----------------------------------------------------------------------------
# Network Settings
# -----------------------------------------------------------------------------
# HTTP API bind address
http.host: "0.0.0.0"
# HTTP API port
http.port: 9600

# -----------------------------------------------------------------------------
# Pipeline Settings
# -----------------------------------------------------------------------------
# Number of workers (threads) per pipeline
pipeline.workers: 2
# Batch size for processing events
pipeline.batch.size: 125
# Delay before delivering undersized batches
pipeline.batch.delay: 50

# Enable ordered processing (important for time-series data)
pipeline.ordered: auto

# -----------------------------------------------------------------------------
# Path Settings
# -----------------------------------------------------------------------------
# Where to store Logstash data
path.data: /usr/share/logstash/data
# Where to write Logstash logs
path.logs: /var/log/logstash

# -----------------------------------------------------------------------------
# Logging Settings
# -----------------------------------------------------------------------------
# Log level (trace, debug, info, warn, error, fatal)
log.level: info
# Log format (plain or json)
log.format: json

# -----------------------------------------------------------------------------
# Monitoring Settings
# -----------------------------------------------------------------------------
# Disable internal metrics collection to Elasticsearch to avoid connection errors
# The licensereader errors occur because monitoring tries to connect
# to localhost:9200 by default. Since we're using the free/basic license and
# don't need internal monitoring features, we disable it.
# Metrics are still available via the HTTP API at port 9600.
#
# NOTE: In Logstash 8.x, 'xpack.monitoring.enabled' is deprecated and replaced
# by 'monitoring.enabled'. Only one of these settings should be configured.
monitoring.enabled: false

# Alternative: Enable monitoring to the Elasticsearch container
# Uncomment these lines if you want to enable monitoring:
# monitoring.enabled: true
# monitoring.elasticsearch.hosts: ["http://elasticsearch:9200"]

# -----------------------------------------------------------------------------
# Dead Letter Queue Settings
# -----------------------------------------------------------------------------
# Enable dead letter queue for failed events
dead_letter_queue.enable: false
# dead_letter_queue.max_bytes: 1024mb
