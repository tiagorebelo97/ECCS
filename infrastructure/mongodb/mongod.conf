# ============================================================================
# MongoDB Configuration for ECCS Platform
# ============================================================================
# This configuration is optimized for containerized logging workloads.
# Adjust values based on container resources and expected log volume.
#
# WORKLOAD PROFILE:
#   - High write throughput for logging
#   - Moderate read access for log queries
#   - TTL indexes for automatic log expiration
# ============================================================================

# Storage settings
storage:
  # Data directory (mounted volume)
  dbPath: /data/db
  # Journal for durability
  journal:
    enabled: true
  # WiredTiger storage engine settings
  wiredTiger:
    engineConfig:
      # Cache size (50% of container memory, max 1GB for logging)
      cacheSizeGB: 0.5
    collectionConfig:
      # Snappy compression for log data (good balance of speed/size)
      blockCompressor: snappy

# Network settings
net:
  # Listen on all interfaces (container networking)
  bindIp: 0.0.0.0
  port: 27017
  # Disable wire compression for local container network
  compression:
    compressors: snappy

# Operation profiling (for debugging slow queries)
operationProfiling:
  # Log slow operations (> 100ms)
  slowOpThresholdMs: 100
  mode: slowOp

# System log settings
systemLog:
  destination: file
  path: /var/log/mongodb/mongod.log
  logAppend: true
  # Log rotation
  logRotate: reopen

# Security settings (enable for production)
# security:
#   authorization: enabled
#   # Keyfile for replica set authentication
#   # keyFile: /etc/mongodb/keyfile

# Replication settings (for future scaling)
# replication:
#   replSetName: eccs-rs

# Process management
processManagement:
  # Run in foreground (required for containers)
  fork: false

# Set parameter overrides
setParameter:
  # Enable free monitoring (optional)
  enableFreeMonitoring: "off"
